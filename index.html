<!DOCTYPE html>

<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Position Size Calculator</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

```
    body {
        font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', system-ui, sans-serif;
        background: #f8f9fa;
        color: #333;
        line-height: 1.6;
        padding: 20px;
    }

    .container {
        max-width: 600px;
        margin: 0 auto;
        background: white;
        border-radius: 12px;
        box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        overflow: hidden;
    }

    .header {
        background: #2563eb;
        color: white;
        padding: 24px;
        text-align: center;
    }

    .header h1 {
        font-size: 1.5rem;
        font-weight: 600;
    }

    .form-section {
        padding: 24px;
    }

    .input-group {
        margin-bottom: 20px;
    }

    .input-group label {
        display: block;
        margin-bottom: 6px;
        font-weight: 500;
        color: #374151;
    }

    .input-group input,
    .input-group select {
        width: 100%;
        padding: 12px;
        border: 1px solid #d1d5db;
        border-radius: 8px;
        font-size: 16px;
        background: white;
        transition: border-color 0.2s;
    }

    .input-group input:focus,
    .input-group select:focus {
        outline: none;
        border-color: #2563eb;
        box-shadow: 0 0 0 3px rgba(37, 99, 235, 0.1);
    }

    .calculate-btn {
        width: 100%;
        background: #2563eb;
        color: white;
        border: none;
        padding: 14px;
        border-radius: 8px;
        font-size: 16px;
        font-weight: 600;
        cursor: pointer;
        transition: background-color 0.2s;
    }

    .calculate-btn:hover {
        background: #1d4ed8;
    }

    .result-section {
        background: #f9fafb;
        border-top: 1px solid #e5e7eb;
        padding: 24px;
    }

    .result-item {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 12px 0;
        border-bottom: 1px solid #e5e7eb;
    }

    .result-item:last-child {
        border-bottom: none;
    }

    .result-label {
        font-weight: 500;
        color: #374151;
    }

    .result-value {
        font-weight: 600;
        color: #111827;
    }

    .result-value.primary {
        color: #2563eb;
        font-size: 1.1rem;
    }

    .result-value.success {
        color: #059669;
    }

    .hidden {
        display: none;
    }
</style>
```

</head>
<body>
    <div class="container">
        <div class="header">
            <h1>Position Size Calculator</h1>
        </div>

```
    <div class="form-section">
        <div class="input-group">
            <label for="accountSize">Account Size ($)</label>
            <input type="number" id="accountSize" value="10000">
        </div>
        
        <div class="input-group">
            <label for="riskPercent">Risk Per Trade (%)</label>
            <input type="number" id="riskPercent" value="0.5" step="0.1" max="5">
        </div>
        
        <div class="input-group">
            <label for="currencyPair">Instrument</label>
            <select id="currencyPair">
                <optgroup label="Major Pairs">
                    <option value="EURUSD">EUR/USD</option>
                    <option value="GBPUSD">GBP/USD</option>
                    <option value="USDJPY">USD/JPY</option>
                    <option value="USDCHF">USD/CHF</option>
                    <option value="AUDUSD">AUD/USD</option>
                    <option value="NZDUSD">NZD/USD</option>
                    <option value="USDCAD">USD/CAD</option>
                </optgroup>
                <optgroup label="Minor Pairs">
                    <option value="EURGBP">EUR/GBP</option>
                    <option value="EURJPY">EUR/JPY</option>
                    <option value="EURCHF">EUR/CHF</option>
                    <option value="GBPJPY">GBP/JPY</option>
                    <option value="GBPCHF">GBP/CHF</option>
                    <option value="AUDJPY">AUD/JPY</option>
                    <option value="AUDCHF">AUD/CHF</option>
                    <option value="NZDJPY">NZD/JPY</option>
                    <option value="NZDCHF">NZD/CHF</option>
                    <option value="CHFJPY">CHF/JPY</option>
                </optgroup>
                <optgroup label="Commodities">
                    <option value="XAUUSD" selected>Gold (XAU/USD)</option>
                    <option value="XAGUSD">Silver (XAG/USD)</option>
                    <option value="USOIL">US Oil</option>
                    <option value="UKOIL">UK Oil</option>
                </optgroup>
                <optgroup label="Indices">
                    <option value="US30">Dow Jones (US30)</option>
                    <option value="US500">S&P 500 (US500)</option>
                    <option value="NAS100">Nasdaq 100</option>
                    <option value="UK100">FTSE 100</option>
                    <option value="GER40">DAX 40</option>
                </optgroup>
                <optgroup label="Cryptocurrencies">
                    <option value="BTCUSD">Bitcoin</option>
                    <option value="ETHUSD">Ethereum</option>
                </optgroup>
            </select>
        </div>
        
        <div class="input-group">
            <label for="entryPrice">Entry Price</label>
            <input type="number" id="entryPrice" value="2050.0" step="0.1">
        </div>
        
        <div class="input-group">
            <label for="stopLoss">Stop Loss Price</label>
            <input type="number" id="stopLoss" value="2040.0" step="0.1">
        </div>

        <div class="input-group">
            <label for="riskReward">Risk:Reward Ratio</label>
            <select id="riskReward">
                <option value="0.5">1:0.5</option>
                <option value="1" selected>1:1</option>
                <option value="1.5">1:1.5</option>
                <option value="2">1:2</option>
                <option value="2.5">1:2.5</option>
                <option value="3">1:3</option>
            </select>
        </div>
        
        <button class="calculate-btn" id="calculateBtn">Calculate Position Size</button>
    </div>
    
    <div id="resultSection" class="result-section hidden">
        <div class="result-item">
            <span class="result-label">Position Size</span>
            <span id="positionSize" class="result-value primary">-</span>
        </div>
        <div class="result-item">
            <span class="result-label">Risk Amount</span>
            <span id="riskAmount" class="result-value">-</span>
        </div>
        <div class="result-item">
            <span class="result-label">Potential Profit</span>
            <span id="potentialProfit" class="result-value success">-</span>
        </div>
        <div class="result-item">
            <span class="result-label">Take Profit</span>
            <span id="takeProfit" class="result-value">-</span>
        </div>
    </div>
</div>

<script>
    class PositionCalculator {
        constructor() {
            this.instruments = {
                // Major Forex Pairs
                'EURUSD': { contractSize: 100000, pipSize: 0.0001, type: 'forex' },
                'GBPUSD': { contractSize: 100000, pipSize: 0.0001, type: 'forex' },
                'USDJPY': { contractSize: 100000, pipSize: 0.01, type: 'forex' },
                'USDCHF': { contractSize: 100000, pipSize: 0.0001, type: 'forex' },
                'AUDUSD': { contractSize: 100000, pipSize: 0.0001, type: 'forex' },
                'NZDUSD': { contractSize: 100000, pipSize: 0.0001, type: 'forex' },
                'USDCAD': { contractSize: 100000, pipSize: 0.0001, type: 'forex' },
                
                // Minor Pairs
                'EURGBP': { contractSize: 100000, pipSize: 0.0001, type: 'forex' },
                'EURJPY': { contractSize: 100000, pipSize: 0.01, type: 'forex' },
                'EURCHF': { contractSize: 100000, pipSize: 0.0001, type: 'forex' },
                'GBPJPY': { contractSize: 100000, pipSize: 0.01, type: 'forex' },
                'GBPCHF': { contractSize: 100000, pipSize: 0.0001, type: 'forex' },
                'AUDJPY': { contractSize: 100000, pipSize: 0.01, type: 'forex' },
                'AUDCHF': { contractSize: 100000, pipSize: 0.0001, type: 'forex' },
                'NZDJPY': { contractSize: 100000, pipSize: 0.01, type: 'forex' },
                'NZDCHF': { contractSize: 100000, pipSize: 0.0001, type: 'forex' },
                'CHFJPY': { contractSize: 100000, pipSize: 0.01, type: 'forex' },
                
                // Commodities
                'XAUUSD': { contractSize: 100, pipSize: 0.1, type: 'commodity' },
                'XAGUSD': { contractSize: 5000, pipSize: 0.01, type: 'commodity' },
                'USOIL': { contractSize: 1000, pipSize: 0.01, type: 'commodity' },
                'UKOIL': { contractSize: 1000, pipSize: 0.01, type: 'commodity' },
                
                // Indices
                'US30': { contractSize: 1, pipSize: 1, type: 'index' },
                'US500': { contractSize: 1, pipSize: 1, type: 'index' },
                'NAS100': { contractSize: 1, pipSize: 1, type: 'index' },
                'UK100': { contractSize: 1, pipSize: 1, type: 'index' },
                'GER40': { contractSize: 1, pipSize: 1, type: 'index' },
                
                // Crypto
                'BTCUSD': { contractSize: 1, pipSize: 1, type: 'crypto' },
                'ETHUSD': { contractSize: 1, pipSize: 1, type: 'crypto' }
            };

            this.exchangeRates = {
                'EURUSD': 1.0950, 'GBPUSD': 1.2750, 'USDJPY': 148.50,
                'USDCHF': 0.8750, 'AUDUSD': 0.6750, 'NZDUSD': 0.6150, 'USDCAD': 1.3550
            };
        }

        calculatePipValue(pair, entryPrice, config) {
            const quote = pair.substring(3, 6);
            const base = pair.substring(0, 3);

            // USD quoted pairs
            if (quote === 'USD') return 10;

            // JPY pairs
            if (quote === 'JPY') {
                const usdJpyRate = this.exchangeRates['USDJPY'] || 148.50;
                const pipValueJPY = config.contractSize * config.pipSize;
                return pipValueJPY / usdJpyRate;
            }

            // USD base pairs
            if (base === 'USD') {
                return (config.contractSize * config.pipSize) / entryPrice;
            }

            // Cross pairs - simplified for major currencies
            const rates = {
                'CHF': 1 / (this.exchangeRates['USDCHF'] || 0.8750),
                'EUR': this.exchangeRates['EURUSD'] || 1.0950,
                'GBP': this.exchangeRates['GBPUSD'] || 1.2750,
                'AUD': this.exchangeRates['AUDUSD'] || 0.6750,
                'NZD': this.exchangeRates['NZDUSD'] || 0.6150,
                'CAD': 1 / (this.exchangeRates['USDCAD'] || 1.3550)
            };

            const baseRate = rates[base] || 1;
            const quoteRate = rates[quote] || 1;

            if (quote === 'CHF' || quote === 'CAD') {
                return (config.contractSize * config.pipSize) / quoteRate;
            } else {
                return (config.contractSize * config.pipSize) * quoteRate;
            }
        }

        calculate(params) {
            const { accountSize, riskPercent, entryPrice, stopLoss, pair, riskReward } = params;
            const config = this.instruments[pair];
            
            if (!config) throw new Error('Unsupported instrument');

            const riskAmount = (riskPercent / 100) * accountSize;
            const priceDiff = Math.abs(entryPrice - stopLoss);
            const pipsAtRisk = priceDiff / config.pipSize;
            const pipValue = this.calculatePipValue(pair, entryPrice, config);
            
            let lotSize = riskAmount / (pipsAtRisk * pipValue);
            lotSize = Math.max(0.01, Math.round(lotSize * 100) / 100); // Round to 2 decimals, min 0.01

            const isLong = stopLoss < entryPrice;
            const profitDistance = priceDiff * parseFloat(riskReward);
            const takeProfitPrice = isLong ? entryPrice + profitDistance : entryPrice - profitDistance;
            const potentialProfit = riskAmount * parseFloat(riskReward);

            return {
                lotSize: lotSize,
                riskAmount,
                potentialProfit,
                takeProfitPrice: parseFloat(takeProfitPrice.toFixed(this.getPricePrecision(pair)))
            };
        }

        getPricePrecision(pair) {
            const config = this.instruments[pair];
            if (pair.includes('JPY')) return 2;
            if (config.type === 'commodity' && pair === 'XAUUSD') return 1;
            if (config.type === 'index' || config.type === 'crypto') return 0;
            return 5;
        }
    }

    const calculator = new PositionCalculator();

    document.getElementById('calculateBtn').addEventListener('click', function() {
        try {
            const params = {
                accountSize: parseFloat(document.getElementById('accountSize').value),
                riskPercent: parseFloat(document.getElementById('riskPercent').value),
                entryPrice: parseFloat(document.getElementById('entryPrice').value),
                stopLoss: parseFloat(document.getElementById('stopLoss').value),
                pair: document.getElementById('currencyPair').value,
                riskReward: document.getElementById('riskReward').value
            };

            const result = calculator.calculate(params);
            
            document.getElementById('positionSize').textContent = result.lotSize.toFixed(2) + ' lots';
            document.getElementById('riskAmount').textContent = '$' + result.riskAmount.toFixed(2);
            document.getElementById('potentialProfit').textContent = '$' + result.potentialProfit.toFixed(2);
            document.getElementById('takeProfit').textContent = result.takeProfitPrice;
            
            document.getElementById('resultSection').classList.remove('hidden');
            
        } catch (error) {
            alert('Calculation error: ' + error.message);
        }
    });

    // Auto-update prices when instrument changes
    document.getElementById('currencyPair').addEventListener('change', function(e) {
        const pair = e.target.value;
        const entryInput = document.getElementById('entryPrice');
        const stopInput = document.getElementById('stopLoss');
        
        const prices = {
            'EURUSD': [1.0950, 1.0900], 'GBPUSD': [1.2750, 1.2700],
            'USDJPY': [148.50, 148.00], 'USDCHF': [0.8750, 0.8700],
            'AUDUSD': [0.6750, 0.6700], 'NZDUSD': [0.6150, 0.6100],
            'USDCAD': [1.3550, 1.3600], 'EURGBP': [0.8550, 0.8500],
            'EURJPY': [162.50, 162.00], 'GBPJPY': [189.50, 189.00],
            'CHFJPY': [184.00, 184.50], 'XAUUSD': [2050.0, 2040.0],
            'XAGUSD': [24.50, 24.00], 'USOIL': [75.50, 74.50],
            'US30': [35000, 34900], 'US500': [4500, 4480],
            'NAS100': [15500, 15450], 'BTCUSD': [43000, 42500],
            'ETHUSD': [2500, 2450]
        };
        
        if (prices[pair]) {
            entryInput.value = prices[pair][0];
            stopInput.value = prices[pair][1];
        }
    });

    // Auto-calculate on page load
    window.addEventListener('load', function() {
        document.getElementById('calculateBtn').click();
    });
</script>
```

</body>
</html>